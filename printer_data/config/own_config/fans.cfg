[fan_generic ebay_fan_1]
pin: PE5
kick_start_time: 0.1


[fan_generic cpu_fan]
pin: PC12
max_power: 1.0
shutdown_speed: 0.0

[gcode_macro CHECK_CPU_TEMP]
gcode:
    {% set HOST_TEMP = printer['temperature_sensor CB1(RPI)'].temperature %}
    
    {% if HOST_TEMP >= 50 %}
        SET_FAN_SPEED FAN=cpu_fan SPEED=1.0
    {% elif HOST_TEMP <= 45 %}
        SET_FAN_SPEED FAN=cpu_fan SPEED=0.0
    {% endif %}

[delayed_gcode check_temp_timer]
initial_duration: 5.0  # Starts 5 seconds after boot
gcode:
    CHECK_CPU_TEMP
    SET_DELAYED_GCODE_TIMER GCODE=check_temp_timer DURATION=10.0 # Runs every 10s